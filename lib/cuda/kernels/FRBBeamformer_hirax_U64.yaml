# Metadata code for CUDA frb beamformer
# This file has been generated automatically by `frb.jl`.
# Do not modify this file, your changes will be lost.

--- !<tag:chord-observatory.ca/x-engine/kernel-description-1.0.0>
kernel-description:
  name: "frb"
  description: "FRB beamformer"
  design-parameters:
    beam-layout: [32, 32]
    dish-layout: [16, 16]
    downsampling-factor: 25
    number-of-complex-components: 2
    number-of-dishes: 256
    number-of-frequencies: 4096
    number-of-polarizations: 2
    number-of-timesamples: 512
    output-gain: 0.005
    sampling-time-μsec: 109.22666666666667
    upchannelization-factor: 64
  compile-parameters:
    minthreads: 512
    blocks_per_sm: 1
  call-parameters:
    threads: [32, 16]
    blocks: [4096]
    shmem_bytes: 34944
  kernel-symbol: "_Z3frb5Int32S_S_S_S_S_S_S_13CuDeviceArrayI7Int16x2Li1ELi1EES0_I9Float16x2Li1ELi1EES0_I6Int4x8Li1ELi1EES0_IS2_Li1ELi1EES0_IS_Li1ELi1EE"
  kernel-arguments:
    - name: "Tmin"
      intent: in
      type: Int32
    - name: "Tmax"
      intent: in
      type: Int32
    - name: "T̄min"
      intent: in
      type: Int32
    - name: "T̄max"
      intent: in
      type: Int32
    - name: "Fmin"
      intent: in
      type: Int32
    - name: "Fmax"
      intent: in
      type: Int32
    - name: "F̄min"
      intent: in
      type: Int32
    - name: "F̄max"
      intent: in
      type: Int32
    - name: "S"
      intent: in
      type: Int16
      indices: [MN, D]
      shape: [2, 256]
      strides: [1, 2]
    - name: "W64"
      intent: in
      type: Float16
      indices: [C, dishM, dishN, P, F]
      shape: [2, 16, 16, 2, 4096]
      strides: [1, 2, 32, 512, 1024, 4194304]
    - name: "Ē64"
      intent: in
      type: Int4
      indices: [C, D, P, F, T]
      shape: [2, 256, 2, 4096, 512]
      strides: [1, 2, 512, 1024, 4194304]
    - name: "I64"
      intent: out
      type: Float16
      indices: [beamP, beamQ, F, Tbar]
      shape: [32, 32, 4096, 64]
      strides: [1, 32, 1024, 4194304]
    - name: "info"
      intent: out
      type: Int32
      indices: [thread, warp, block]
      shapes: [32, 16, 4096]
      strides: [1, 32, 512]
...
